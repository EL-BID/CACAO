<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" th:with="lang=${#locale.language}" th:lang="${lang}">
<head th:replace="fragments/page_fragments :: header">
	<!-- Although the entire head will be replaced, its necessary to establish the charset
	for all static content before the Thymeleaf processing. -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
	<!-- Fix to avoid overlap from the Menu -->
	<div>
		<br>
	</div>
	<div class="ui container">
		<h2 class="ui header">
			<i class="archive icon"></i>
			<div class="content" th:text="#{docs.history}">All Uploads</div>
		</h2>
			<div id="app">
				<div id="table" class="ui orange table"></div>
			</div>
		<div class="ui column right floated">
			<div class="ui right floated primary labeled icon">
				<a th:href="@{/docs}" class="ui button"><i class="plus icon"></i><span th:text="#{docs.main.upload}">Upload Documents</span></a>
			</div>
		</div>
	</div>
 
<script th:nonce="${cspNonce}" th:inline="javascript">
dateFormatter = function(cell, formatterParams, onRendered) {
	var newDate= (window.DateTime || luxon.DateTime).fromISO(cell.getValue())
	if(newDate.isValid) {
		return newDate.toFormat('yyyy-MM-dd HH:mm:ss')
	}
	return cell.getValue()
}

var app = new Vue({
	el: '#app',
	data: {
		table: null
	},
	mounted() {
		this.table = new Tabulator('#table', {
			index: 'id',
			layout: "fitColumns", //fit columns to width of table (optional)
		    pagination: true,
			paginationMode: "remote", //enable remote pagination
    		ajaxURL: /*[[@{/api/docs_search}]]*/ "/api/docs_seach", //set url for ajax request
			paginationSize: 5,
			ajaxContentType: "json",
			
			columns:[ //Define Table Columns
				{title: /*[[#{doc.user}]]*/ "User", field:"user"},
				//{title: /*[[#{taxpayer.id}]]*/ "Tax Payer Id", field:"taxPayerId" },
				{title: /*[[#{doc.template}]]*/ "Template", field:"templateName" },
				{title: /*[[#{doc.timestamp}]]*/ "Date/time uploaded", field:"timestamp", formatter: dateFormatter},
				{title: /*[[#{doc.situation}]]*/ "Situation", field:"situation" },
				{title: /*{{#doc.id}}} */ "Document Id", field:"id"},
			]
		})
	}
})
</script>
</body>
</html>
    
