<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" th:with="lang=${#locale.language}" th:lang="${lang}">
<head th:replace="fragments/page_fragments :: header(more_links=~{this::link}, more_scripts=~{this::script[src]})">
	<!-- Although the entire head will be replaced, its necessary to establish the charset
	for all static content before the Thymeleaf processing. -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" type="text/css" class="ui" href="/css/tabulator_semantic-ui.min.css">
	<script src="/js/tabulator.min.js"></script>
	<script src="/js/luxon.min.js"><</script>
</head>
<body>
	<!-- Fix to avoid overlap from the Menu -->
	<div>
		<br>
	</div>
	<div class="ui container">
		<h2 class="ui header">
			<i class="file alternate outline icon"></i>
			<div class="content" th:text="#{templates}">All Templates</div>
		</h2>
			<div id="app">
				<div id="table" class="ui orange table"></div>
			</div>
		<div class="ui column right floated">
			<div class="ui right floated primary labeled icon">
				<a th:href="@{/templates/add}" class="ui blue button"><i class="plus icon"></i><span th:text="#{template.new}">New Template</span></a>
			</div>
		</div>
	</div>
 
<script th:nonce="${cspNonce}" th:inline="javascript">
var editRow = function(e, cell) {
	e.stopPropagation();
	window.location.replace([[@{/templates/}]] +  cell.getRow().getIndex() + "/edit");
}
var editIcon = function(cell, formatterParams){ return "<i class='edit icon'></i>"};
var tableData = /*[[${templates}]]*/ null;
table = new Tabulator('#table', {
	index: 'id',
	layout: "fitDataFill", //fit columns to width of table (optional)
    pagination: true,
	paginationSize: 5,
	data: tableData,
	responsiveLayout:"collapse",
    //persistence:{
	//	columns:true,
	//},			
	//persistenceID:"docs_templates_persistence",	
	columns:[ //Define Table Columns
		{formatter:editIcon, tooltip: /*{{#{edit}}} */ "Edit", cellClick: editRow, headerSort:false, width:45, responsive:0},
		{title: /*[[#{template.name}]]*/ "Name", field:"name", responsive:0},
		{title: /*[[#{template.group}]]*/ "Group", field:"group", responsive:3},
		{title: /*[[#{template.version}]]*/ "Version", field:"version", responsive:1},
		{title: /*[[#{template.periodicity}]]*/ "Periodicity", field:"periodicity", minWidth:150, responsive:2 },
		{title: '<i class="asterisk icon"></i>', titleFormatter:'html', tooltip:/*[[#{field.required}]]*/ "Required", field:"required",  
			formatter:"tickCross", formatterParams: { crossElement:false}, width:40}
	]
})
table.on('rowClick', function(e, row) {
	if( e.target.classList.contains('edit')) {
		return
	}
	window.location.replace([[@{/templates/}]] + row.getIndex());
})
</script>
</body>
</html>
    
